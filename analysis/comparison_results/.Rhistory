dat_sp_detailed <- "../collect_results/alldat_spatialUnits_detailed.Rdata"
#dat_sp_detailed <- "./alldat_spatialUnits_detailed.Rdata"
# R object with slopelength data
dat_sl <- "../collect_results/alldat_slopelength.Rdata"
#dat_sl <- "./alldat_slopelength.Rdata"
# R object with mean slopes of LUs
dat_slope <- "../collect_results/alldat_meanslope.Rdata"
#dat_slope <- "./alldat_meanslope.Rdata"
# R object with no. of soil types
dat_nosoils <- "../collect_results/alldat_number_soiltypes.Rdata"
#dat_nosoils <- "./alldat_number_soiltypes.Rdata"
# R object with streamflow data when reservoirs switched off
dat_flow_resoff <- "../collect_results/alldat_resoff_streamflow_m3s_xts.Rdata"
# plot out file
file_out <- "Bengue_inflow"
file_out_vol <- "Bengue_resvol"
# observed data file
file_obs <- "./lista_aportes_diario_177.csv"
# RESERVOIR LEVEL #
load(dat_level)
dat_level <- dat_all[,1:100]
load(dat_pr)
dat_prec <- dat_all[,1] # only one column as area-weighted precipitation sum over the catchment is always the same (has been checked)
dat_prec <- tidy(dat_prec)
dat_prec$series <- "prec"
rm(dat_all)
dat_obs <- read.table(file_obs, header=T, sep=";", skip = 4)
dat_obs_level_xts <- xts(dat_obs$Volume..hm.., as.Date(dat_obs$Data))
colnames(dat_obs_level_xts) <- "obs"
rm(dat_obs)
dat_all <- merge(dat_level,dat_obs_level_xts, all=F)
rm(dat_level, dat_obs_level_xts)
dat_all <- tidy(dat_all)
dat_all <- rbind(dat_all, dat_prec)
gp <- ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_bar(data = subset(dat_all, series == "prec"), stat="identity", mapping = aes(fill="test")) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="test2")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="test3")) +
scale_x_date("Date", limits = c(as.Date("2001-01-01"), as.Date("2013-12-31")), date_breaks = "2 years", date_minor_breaks = "1 year") +
scale_color_manual(values=c("gray50", "black")) + scale_fill_manual(values = "lightblue") +
ylab(expression(paste("Water Volume / ", hm^3))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99)) +
guides(colour = guide_legend(title=NULL),
fill = guide_legend(title=NULL, override.aes = list(fill=NA, linetype=1, colour="lightblue")))
ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_bar(data = subset(dat_all, series == "prec"), stat="identity", mapping = aes(fill="test")) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="test2")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="test3")) +
scale_x_date("Date", limits = c(as.Date("2001-01-01"), as.Date("2013-12-31")), date_breaks = "2 years", date_minor_breaks = "1 year") +
scale_color_manual(values=c("gray50", "black")) + scale_fill_manual(values = "lightblue") +
ylab(expression(paste("Water Volume / ", hm^3))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99)) +
guides(colour = guide_legend(title=NULL),
fill = guide_legend(title=NULL, override.aes = list(fill=NA, linetype=1, colour="lightblue")))
ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_bar(data = subset(dat_all, series == "prec"), stat="identity")+#, mapping = aes(fill="test")) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="test2")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="test3")) +
scale_x_date("Date", limits = c(as.Date("2001-01-01"), as.Date("2013-12-31")), date_breaks = "2 years", date_minor_breaks = "1 year") +
scale_color_manual(values=c("gray50", "black")) + scale_fill_manual(values = "lightblue") +
ylab(expression(paste("Water Volume / ", hm^3))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99)) +
guides(colour = guide_legend(title=NULL),
fill = guide_legend(title=NULL, override.aes = list(fill=NA, linetype=1, colour="lightblue")))
ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_bar(data = subset(dat_all, series == "prec"), stat="identity")+#, mapping = aes(fill="test")) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="test2")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="test3")) +
scale_x_date("Date", limits = c(as.Date("2001-01-01"), as.Date("2013-12-31")), date_breaks = "2 years", date_minor_breaks = "1 year") +
scale_color_manual(values=c("gray50", "black")) + scale_fill_manual(values = "lightblue") +
ylab(expression(paste("Water Volume / ", hm^3)))
ggplot(dat_all, aes(x=index, y=value, group=series)) +
#geom_bar(data = subset(dat_all, series == "prec"), stat="identity")+#, mapping = aes(fill="test")) +
geom_line(data = subset(dat_all, series == "prec", lwd=0.5, mapping = aes(colour="test2"))) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="test2")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="test3")) +
scale_x_date("Date", limits = c(as.Date("2001-01-01"), as.Date("2013-12-31")), date_breaks = "2 years", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "gray50", "black")) + #scale_fill_manual(values = "lightblue") +
ylab(expression(paste("Water Volume / ", hm^3))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99))
ggplot(dat_all, aes(x=index, y=value, group=series)) +
#geom_bar(data = subset(dat_all, series == "prec"), stat="identity")+#, mapping = aes(fill="test")) +
geom_line(data = subset(dat_all, series == "prec", lwd=0.5, mapping = aes(colour="test"))) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="test2")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="test3")) +
scale_x_date("Date", limits = c(as.Date("2001-01-01"), as.Date("2013-12-31")), date_breaks = "2 years", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "gray50", "black")) + #scale_fill_manual(values = "lightblue") +
ylab(expression(paste("Water Volume / ", hm^3))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99))
ggplot(dat_all, aes(x=index, y=value, group=series)) +
#geom_bar(data = subset(dat_all, series == "prec"), stat="identity")+#, mapping = aes(fill="test")) +
geom_line(data = subset(dat_all, series == "prec"), lwd=0.5, mapping = aes(colour="test")) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="test2")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="test3")) +
scale_x_date("Date", limits = c(as.Date("2001-01-01"), as.Date("2013-12-31")), date_breaks = "2 years", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "gray50", "black")) + #scale_fill_manual(values = "lightblue") +
ylab(expression(paste("Water Volume / ", hm^3))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99))
ggplot(dat_all, aes(x=index, y=value, group=series)) +
#geom_bar(data = subset(dat_all, series == "prec"), stat="identity")+#, mapping = aes(fill="test")) +
geom_line(data = subset(dat_all, series == "prec"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir level")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
scale_x_date("Date", limits = c(as.Date("2001-01-01"), as.Date("2013-12-31")), date_breaks = "2 years", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "gray50", "black")) + #scale_fill_manual(values = "lightblue") +
ylab(expression(paste("Water Volume / ", hm^3))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99))
ggplot(dat_all, aes(x=index, y=value, group=series)) +
#geom_bar(data = subset(dat_all, series == "prec"), stat="identity")+#, mapping = aes(fill="test")) +
geom_line(data = subset(dat_all, series == "prec"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir level")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
scale_x_date("Date", limits = c(as.Date("2001-01-01"), as.Date("2013-12-31")), date_breaks = "2 years", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "gray50", "black")) + #scale_fill_manual(values = "lightblue") +
ylab(expression(paste("Water Volume / ", hm^3))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99)) +
guides(colour = guide_legend(title=NULL))
ggplot(dat_all, aes(x=index, y=value, group=series)) +
#geom_bar(data = subset(dat_all, series == "prec"), stat="identity")+#, mapping = aes(fill="test")) +
geom_line(data = subset(dat_all, series == "prec"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir level")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
scale_x_date("Date", limits = c(as.Date("2001-01-01"), as.Date("2013-12-31")), date_breaks = "2 years", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "black", "gray50")) +
ylab(expression(paste("Water Volume / ", hm^3))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99)) +
guides(colour = guide_legend(title=NULL))
gp <- ggplot(dat_all, aes(x=index, y=value, group=series)) +
#geom_bar(data = subset(dat_all, series == "prec"), stat="identity")+#, mapping = aes(fill="test")) +
geom_line(data = subset(dat_all, series == "prec"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir level")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
scale_x_date("Date", limits = c(as.Date("2001-01-01"), as.Date("2013-12-31")), date_breaks = "2 years", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "black", "gray50")) +
ylab(expression(paste("Water Volume / ", hm^3))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99)) +
guides(colour = guide_legend(title=NULL))
ggsave(paste0(file_out_vol, "_overview.png"), plot = gp, width=14, height=8, units="in", dpi=300)
gp <- ggplot(dat_all, aes(x=index, y=value, group=series)) +
#geom_bar(data = subset(dat_all, series == "prec"), stat="identity")+#, mapping = aes(fill="test")) +
geom_line(data = subset(dat_all, series == "prec"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir level")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
scale_x_date("Date", limits = c(as.Date("2001-01-01"), as.Date("2013-12-31")), date_breaks = "2 years", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "black", "gray50")) +
ylab(expression(paste("Water Volume / ", hm^3))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99)) +
guides(colour = guide_legend(title=NULL))
ggsave(paste0(file_out_vol, "_overview.png"), plot = gp, width=14, height=6, units="in", dpi=300)
# RESERVOIR LEVEL #
load(dat_level)
dat_level <- dat_all[seq.Date(period[1], period[2], by="day"),1:100]
load(dat_pr)
dat_prec <- dat_all[seq.Date(period[1], period[2], by="day"),1] # only one column as area-weighted precipitation sum over the catchment is always the same (has been checked)
dat_prec <- tidy(dat_prec)
dat_prec$series <- "prec"
rm(dat_all)
dat_obs <- read.table(file_obs, header=T, sep=";", skip = 4)
dat_obs_level_xts <- xts(dat_obs$Volume..hm.., as.Date(dat_obs$Data))
colnames(dat_obs_level_xts) <- "obs"
rm(dat_obs)
dat_all <- merge(dat_level,dat_obs_level_xts, all=F)
rm(dat_level, dat_obs_level_xts)
dat_all <- tidy(dat_all)
dat_all <- rbind(dat_all, dat_prec)
period <- c(as.Date("2006-01-01"), as.Date("2013-12-31"))
# RESERVOIR LEVEL #
load(dat_level)
dat_level <- dat_all[seq.Date(period[1], period[2], by="day"),1:100]
load(dat_pr)
dat_prec <- dat_all[seq.Date(period[1], period[2], by="day"),1] # only one column as area-weighted precipitation sum over the catchment is always the same (has been checked)
dat_prec <- tidy(dat_prec)
dat_prec$series <- "prec"
rm(dat_all)
dat_obs <- read.table(file_obs, header=T, sep=";", skip = 4)
dat_obs_level_xts <- xts(dat_obs$Volume..hm.., as.Date(dat_obs$Data))
colnames(dat_obs_level_xts) <- "obs"
rm(dat_obs)
dat_all <- merge(dat_level,dat_obs_level_xts, all=F)
rm(dat_level, dat_obs_level_xts)
dat_all <- tidy(dat_all)
dat_all <- rbind(dat_all, dat_prec)
load(dat_level)
library(xts)
library(ggplot2)
library(broom)
library(plyr)
library(dplyr)
library(tidyr)
# working dir
#setwd("/mnt/scratch/users/stud06/tpilz/LUMP_paper/analysis/comparison_results/")
setwd("/home/tobias/Promotion/Paper/lumpR/analysis/comparison_results/")
#setwd("/home/tobias/Promotion/Modellierung/LUMP-Paper/analysis/backup_cluster/analysis/comparison_results/")
#setwd("/home/tobias/Promotion/Modellierung/LUMP-Paper/analysis/compare_multiruns/")
# R object with collected simulation data
dat <- "../collect_results/alldat_Bengue_inflow_m3s_xts.Rdata"
#dat <- "./dat_test_Bengue_inflow_m3s_xts.Rdata"
# R object with precipitation data
dat_pr <- "../collect_results/alldat_precip_sum_hm3_xts.Rdata"
#dat_pr <- "./alldat_precip_sum_hm3_xts.Rdata"
# R object with collected simulated reservoir filling volume data
dat_level <- "../collect_results/alldat_Bengue_reslevel_hm3_xts.Rdata"
#dat_level <- "./alldat_Bengue_reslevel_hm3_xts.Rdata"
# R objects with information of actually generated spatial units
dat_sp <- "../collect_results/alldat_spatialUnits.Rdata"
#dat_sp <- "./dat_test_spatialUnits.Rdata"
dat_sp_detailed <- "../collect_results/alldat_spatialUnits_detailed.Rdata"
#dat_sp_detailed <- "./alldat_spatialUnits_detailed.Rdata"
# R object with slopelength data
dat_sl <- "../collect_results/alldat_slopelength.Rdata"
#dat_sl <- "./alldat_slopelength.Rdata"
# R object with mean slopes of LUs
dat_slope <- "../collect_results/alldat_meanslope.Rdata"
#dat_slope <- "./alldat_meanslope.Rdata"
# R object with no. of soil types
dat_nosoils <- "../collect_results/alldat_number_soiltypes.Rdata"
#dat_nosoils <- "./alldat_number_soiltypes.Rdata"
# R object with streamflow data when reservoirs switched off
dat_flow_resoff <- "../collect_results/alldat_resoff_streamflow_m3s_xts.Rdata"
# plot out file
file_out <- "Bengue_inflow"
file_out_vol <- "Bengue_resvol"
# observed data file
file_obs <- "./lista_aportes_diario_177.csv"
# time frame that shall be used for analysis (e.g., warm up period can be excluded); only applied to certain plots
period <- c(as.Date("2006-01-01"), as.Date("2013-12-31"))
# RESERVOIR LEVEL #
load(dat_level)
dat_level <- dat_all[seq.Date(period[1], period[2], by="day"),1:100]
load(dat_pr)
dat_prec <- dat_all[seq.Date(period[1], period[2], by="day"),1] # only one column as area-weighted precipitation sum over the catchment is always the same (has been checked)
dat_prec <- tidy(dat_prec)
dat_prec$series <- "prec"
rm(dat_all)
dat_obs <- read.table(file_obs, header=T, sep=";", skip = 4)
dat_obs_level_xts <- xts(dat_obs$Volume..hm.., as.Date(dat_obs$Data))
colnames(dat_obs_level_xts) <- "obs"
rm(dat_obs)
dat_all <- merge(dat_level,dat_obs_level_xts, all=F)
rm(dat_level, dat_obs_level_xts)
dat_all <- tidy(dat_all)
dat_all <- rbind(dat_all, dat_prec)
gp <- ggplot(dat_all, aes(x=index, y=value, group=series)) +
#geom_bar(data = subset(dat_all, series == "prec"), stat="identity")+#, mapping = aes(fill="test")) +
geom_line(data = subset(dat_all, series == "prec"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir level")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
scale_x_date("Date", limits = c(as.Date("2001-01-01"), as.Date("2013-12-31")), date_breaks = "2 years", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "black", "gray50")) +
ylab(expression(paste("Water Volume / ", hm^3))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99)) +
guides(colour = guide_legend(title=NULL))
ggsave(paste0(file_out_vol, "_overview.png"), plot = gp, width=14, height=6, units="in", dpi=300)
gp <- ggplot(dat_all, aes(x=index, y=value, group=series)) +
#geom_bar(data = subset(dat_all, series == "prec"), stat="identity")+#, mapping = aes(fill="test")) +
geom_line(data = subset(dat_all, series == "prec"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir level")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
scale_x_date("Date", date_breaks = "2 years", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "black", "gray50")) +
ylab(expression(paste("Water Volume / ", hm^3))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99)) +
guides(colour = guide_legend(title=NULL))
ggsave(paste0(file_out_vol, "_overview.png"), plot = gp, width=14, height=6, units="in", dpi=300)
gp <- ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "prec"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir level")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "black", "gray50")) +
ylab(expression(paste("Water Volume / ", hm^3))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99)) +
guides(colour = guide_legend(title=NULL))
ggsave(paste0(file_out_vol, "_overview.png"), plot = gp, width=14, height=6, units="in", dpi=300)
gp <- ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "prec"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir level")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "6 months") +
scale_color_manual(values=c("lightblue", "black", "gray50")) +
ylab(expression(paste("Water Volume / ", hm^3))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99)) +
guides(colour = guide_legend(title=NULL))
ggsave(paste0(file_out_vol, "_overview.png"), plot = gp, width=14, height=6, units="in", dpi=300)
gp <- ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "prec"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir level")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "0.5 year") +
scale_color_manual(values=c("lightblue", "black", "gray50")) +
ylab(expression(paste("Water Volume / ", hm^3))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99)) +
guides(colour = guide_legend(title=NULL))
ggsave(paste0(file_out_vol, "_overview.png"), plot = gp, width=14, height=6, units="in", dpi=300)
gp <- ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "prec"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir level")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
scale_x_date("Date", date_breaks = "12 months", date_minor_breaks = "6 months") +
scale_color_manual(values=c("lightblue", "black", "gray50")) +
ylab(expression(paste("Water Volume / ", hm^3))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99)) +
guides(colour = guide_legend(title=NULL))
ggsave(paste0(file_out_vol, "_overview.png"), plot = gp, width=14, height=6, units="in", dpi=300)
gp <- ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "prec"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir level")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "6 months") +
scale_color_manual(values=c("lightblue", "black", "gray50")) +
ylab(expression(paste("Water Volume / ", hm^3))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99)) +
guides(colour = guide_legend(title=NULL))
ggsave(paste0(file_out_vol, "_overview.png"), plot = gp, width=14, height=6, units="in", dpi=300)
gp <- ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "prec"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir level")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "black", "gray50")) +
ylab(expression(paste("Water Volume / ", hm^3))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99)) +
guides(colour = guide_legend(title=NULL))
ggsave(paste0(file_out_vol, "_overview.png"), plot = gp, width=14, height=6, units="in", dpi=300)
gp <- ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "prec"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir levels")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "black", "gray50")) +
ylab(expression(paste("Water Volume / ", hm^3))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99)) +
guides(colour = guide_legend(title=NULL, override.aes = list(size=2)))
ggsave(paste0(file_out_vol, "_overview.png"), plot = gp, width=14, height=6, units="in", dpi=300)
gp <- ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "prec"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir levels")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "black", "gray50")) +
ylab(expression(paste("Water Volume / ", hm^3))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99)) +
guides(colour = guide_legend(title=NULL, override.aes = list(size=1.5)))
ggsave(paste0(file_out_vol, "_overview.png"), plot = gp, width=14, height=6, units="in", dpi=300)
gp <- ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "prec"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir levels")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "black", "gray50")) +
ylab(expression(paste("Water Volume / ", hm^3))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99), legend.key.width = unit(5,"pt")) +
guides(colour = guide_legend(title=NULL, override.aes = list(size=1.5)))
ggsave(paste0(file_out_vol, "_overview.png"), plot = gp, width=14, height=6, units="in", dpi=300)
gp <- ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "prec"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir levels")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "black", "gray50")) +
ylab(expression(paste("Water Volume / ", hm^3))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99), legend.key.width = unit(15,"pt")) +
guides(colour = guide_legend(title=NULL, override.aes = list(size=1.5)))
ggsave(paste0(file_out_vol, "_overview.png"), plot = gp, width=14, height=6, units="in", dpi=300)
gp <- ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "prec"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir levels")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "black", "gray50")) +
ylab(expression(paste("Water Volume / ", hm^3))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99), legend.key.width = unit(20,"pt")) +
guides(colour = guide_legend(title=NULL, override.aes = list(size=1.5)))
ggsave(paste0(file_out_vol, "_overview.png"), plot = gp, width=14, height=6, units="in", dpi=300)
gp <- ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "prec"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir levels")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "black", "gray50")) +
ylab(expression(paste("Water Volume / ", hm^3))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99), legend.key.width = unit(25,"pt")) +
guides(colour = guide_legend(title=NULL, override.aes = list(size=1.2)))
ggsave(paste0(file_out_vol, "_overview.png"), plot = gp, width=14, height=6, units="in", dpi=300)
library(xts)
library(ggplot2)
library(broom)
library(plyr)
library(dplyr)
library(tidyr)
# working dir
#setwd("/mnt/scratch/users/stud06/tpilz/LUMP_paper/analysis/comparison_results/")
setwd("/home/tobias/Promotion/Paper/lumpR/analysis/comparison_results/")
#setwd("/home/tobias/Promotion/Modellierung/LUMP-Paper/analysis/backup_cluster/analysis/comparison_results/")
#setwd("/home/tobias/Promotion/Modellierung/LUMP-Paper/analysis/compare_multiruns/")
# R object with collected simulation data
dat <- "../collect_results/alldat_Bengue_inflow_m3s_xts.Rdata"
#dat <- "./dat_test_Bengue_inflow_m3s_xts.Rdata"
# R object with precipitation data
dat_pr <- "../collect_results/alldat_precip_sum_hm3_xts.Rdata"
#dat_pr <- "./alldat_precip_sum_hm3_xts.Rdata"
# R object with collected simulated reservoir filling volume data
dat_level <- "../collect_results/alldat_Bengue_reslevel_hm3_xts.Rdata"
#dat_level <- "./alldat_Bengue_reslevel_hm3_xts.Rdata"
# R objects with information of actually generated spatial units
dat_sp <- "../collect_results/alldat_spatialUnits.Rdata"
#dat_sp <- "./dat_test_spatialUnits.Rdata"
dat_sp_detailed <- "../collect_results/alldat_spatialUnits_detailed.Rdata"
#dat_sp_detailed <- "./alldat_spatialUnits_detailed.Rdata"
# R object with slopelength data
dat_sl <- "../collect_results/alldat_slopelength.Rdata"
#dat_sl <- "./alldat_slopelength.Rdata"
# R object with mean slopes of LUs
dat_slope <- "../collect_results/alldat_meanslope.Rdata"
#dat_slope <- "./alldat_meanslope.Rdata"
# R object with no. of soil types
dat_nosoils <- "../collect_results/alldat_number_soiltypes.Rdata"
#dat_nosoils <- "./alldat_number_soiltypes.Rdata"
# R object with streamflow data when reservoirs switched off
dat_flow_resoff <- "../collect_results/alldat_resoff_streamflow_m3s_xts.Rdata"
# plot out file
file_out <- "Bengue_inflow"
file_out_vol <- "Bengue_resvol"
# observed data file
file_obs <- "./lista_aportes_diario_177.csv"
# time frame that shall be used for analysis (e.g., warm up period can be excluded); only applied to certain plots
period <- c(as.Date("2006-01-01"), as.Date("2013-12-31"))
load(dat_pr)
dat_all <- dat_all[,1:100]
# time series of monthly and yearly sums
dat_all_m <- apply.monthly(dat_all, colSums, na.rm=F)
dat_all_y <- apply.yearly(dat_all, colSums, na.rm=F)
# re-shape xts object for plotting with ggplot2
dat_tidy_d <- cbind(tidy(dat_all), aggregation="daily")
dat_tidy_m <- cbind(tidy(dat_all_m), aggregation="monthly")
dat_tidy_y <- cbind(tidy(dat_all_y), aggregation="yearly")
rm(dat_all, dat_all_m, dat_all_y)
dat_tidy <- rbind(dat_tidy_d, dat_tidy_m, dat_tidy_y)
rm(dat_tidy_d, dat_tidy_m, dat_tidy_y)
str(dat_tidy)
?diff
diff(c(1,5,10,6,3))
max(abs(diff(c(1,5,10,6,3))))
?tapply
tapply(1:10, list(c("a", "a", "b", "b", "b", "a", "a", "b", "b", "b")), sum)
dat_diff <- tapply(dat_tidy$value, list(dat_tidy$index, dat_tidy$aggregation), function(x) max(abs(diff(x))))
str(dat_diff)
str(as.data.frame(dat_diff))
str(tidy(dat_diff))
?ddply
dat_diff <- dat_tidy %>%
ddply(c("index", "aggregation"), function(x) {
x %>%
summarise(diffs = max(abs(diff(value))))
})
str(dat_diff)
library(doMC)
registerDoMC(cores=8)
dat_diff <- dat_tidy %>%
ddply(c("index", "aggregation"), .parallel=T, function(x) {
x %>%
summarise(diffs = max(abs(diff(value))))
})
ggplot(dat_diff, aes(x=index, y=diffs, group=aggregations)) +
geom_line(colour="gray", lwd=0.5) +
facet_grid(aggregation ~ ., scale="free_y") +
scale_x_date("Year", limits = c(as.Date("2001-01-01"), as.Date("2013-12-31")), date_breaks = "2 years", date_minor_breaks = "1 year") +
ylab(expression(paste("Rainfall volume / ", hm^3))) +
theme_bw()
ggplot(dat_diff, aes(x=index, y=diffs, group=aggregation)) +
geom_line(colour="gray", lwd=0.5) +
facet_grid(aggregation ~ ., scale="free_y") +
scale_x_date("Year", limits = c(as.Date("2001-01-01"), as.Date("2013-12-31")), date_breaks = "2 years", date_minor_breaks = "1 year") +
ylab(expression(paste("Rainfall volume / ", hm^3))) +
theme_bw()
min(dat_diff$diffs)
max(dat_diff$diffs)
dat_diff <- tapply(dat_tidy$value, list(dat_tidy$index, dat_tidy$aggregation), function(x) max(abs(diff(x))))
min(dat_diff)
min(dat_diff, na.rm = T)
max(dat_diff, na.rm = T)
ggplot(dat_tidy, aes(x=index, y=value, group=series)) +
geom_line(colour="gray", lwd=0.5) +
facet_grid(aggregation ~ ., scale="free_y") +
scale_x_date("Year", limits = c(as.Date("2001-01-01"), as.Date("2013-12-31")), date_breaks = "2 years", date_minor_breaks = "1 year") +
ylab(expression(paste("Rainfall volume / ", hm^3))) +
theme_bw()
