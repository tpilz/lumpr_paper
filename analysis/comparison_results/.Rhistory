#ggsave(file_out_rc_compare, plot = gp, width=7, height=6, units="in", dpi=300)
pdf("test.pdf", width=14, height=5)
grid.arrange(gp1, gp2, widths=c(.5,.5), ncol=2, nrow=1)
dev.off()
file_out_prec_rc_compare <- "Bengue_prec_rc_compare.pdf"
library(xts)
library(ggplot2)
library(broom)
library(plyr)
library(dplyr)
library(tidyr)
library(doMC)
registerDoMC(cores=8)
getwd()
# R object with collected simulation data
dat <- "../collect_results/alldat_Bengue_inflow_m3s_xts.Rdata"
#dat <- "./alldat_Bengue_inflow_m3s_xts.Rdata"
# R object with precipitation data
dat_pr <- "../collect_results/alldat_precip_sum_hm3_xts.Rdata"
#dat_pr <- "./alldat_precip_sum_hm3_xts.Rdata"
# R object with collected simulated reservoir filling volume data
dat_level <- "../collect_results/alldat_Bengue_reslevel_hm3_xts.Rdata"
#dat_level <- "./alldat_Bengue_reslevel_hm3_xts.Rdata"
# output files #
# Bengue inflows: overview
file_out_inflow_overview <- "Bengue_inflow_overview.png"
file_out_reslevel_paper <- "Bengue_resvol_overview.png"
file_out_prec_overview <- "rainfall_area-weighted_overview.png"
file_out_prec_diffs <- "rainfall_maxabsdiff_experiments_overview.png"
file_out_prec_rc_compare <- "Bengue_prec_rc_compare.pdf"
file_out <- "Bengue_inflow"
file_out_vol <- "Bengue_resvol"
# observed data file
file_obs <- "./lista_aportes_diario_177.csv"
# time frame that shall be used for analysis (e.g., warm up period can be excluded); only applied to certain plots
period <- c(as.Date("2006-01-01"), as.Date("2013-12-31"))
load(dat_pr)
dat_all <- dat_all[,1:100] * 1.08 # get values in mm by incorporating catchment area via factor: 1 hm3 / 926 km2 = 1e9 l / 0.926e9 m2 = 1.08 mm
# time series of monthly and yearly sums
dat_all_m <- apply.monthly(dat_all, colSums, na.rm=F)
dat_all_y <- apply.yearly(dat_all, colSums, na.rm=F)
# re-shape xts object for plotting with ggplot2
dat_tidy_d <- cbind(tidy(dat_all), aggregation="daily")
dat_tidy_m <- cbind(tidy(dat_all_m), aggregation="monthly")
dat_tidy_y <- cbind(tidy(dat_all_y), aggregation="yearly")
rm(dat_all, dat_all_m, dat_all_y)
dat_tidy <- rbind(dat_tidy_d, dat_tidy_m, dat_tidy_y)
rm(dat_tidy_d, dat_tidy_m, dat_tidy_y)
# plot
gp <- ggplot(dat_tidy, aes(x=index, y=value, group=series)) +
geom_line(colour="gray", lwd=0.5) +
facet_grid(aggregation ~ ., scale="free_y") +
scale_x_date("Year", limits = c(as.Date("2001-01-01"), as.Date("2013-12-31")), date_breaks = "2 years", date_minor_breaks = "1 year") +
ylab("Rainfall (mm)") +
theme_bw(base_size = 18)
ggsave(file_out_prec_overview, plot = gp, width=14, height=8, units="in", dpi=300)
str(dat_tidy)
which(is.na(dat_tidy))
dat_tidy[1:100,1:10]
dat_tidy[1:100,]
tail(dat_tidy)
rm(dat_all)
rm(dat_tidy)
load(dat_pr)
dat_all <- dat_all[,1:1000] * 1.08 # get values in mm by incorporating catchment area via factor: 1 hm3 / 926 km2 = 1e9 l / 0.926e9 m2 = 1.08 mm
# time series of monthly and yearly sums
dat_all_m <- apply.monthly(dat_all, colSums, na.rm=F)
dat_all_y <- apply.yearly(dat_all, colSums, na.rm=F)
# re-shape xts object for plotting with ggplot2
dat_tidy_d <- cbind(tidy(dat_all), aggregation="daily")
dat_tidy_m <- cbind(tidy(dat_all_m), aggregation="monthly")
dat_tidy_y <- cbind(tidy(dat_all_y), aggregation="yearly")
rm(dat_all, dat_all_m, dat_all_y)
dat_tidy <- rbind(dat_tidy_d, dat_tidy_m, dat_tidy_y)
rm(dat_tidy_d, dat_tidy_m, dat_tidy_y)
dat_diff <- dat_tidy %>%
ddply(c("index", "aggregation"), .parallel=T, function(x) {
x %>%
summarise(diffs = max(abs(diff(value))))
})
str(dat_diff)
load(dat_level)
dat_level <- dat_all[seq.Date(period[1], period[2], by="day"),1:100]
load(dat_pr)
dat_prec <- dat_all[seq.Date(period[1], period[2], by="day"),1] # only one column as area-weighted precipitation sum over the catchment is almost the same (has been checked)
dat_prec <- tidy(dat_prec)
dat_prec$series <- "prec"
rm(dat_all)
dat_obs <- read.table(file_obs, header=T, sep=";", skip = 4)
dat_obs_level_xts <- xts(dat_obs$Volume..hm.., as.Date(dat_obs$Data))
colnames(dat_obs_level_xts) <- "obs"
rm(dat_obs)
dat_all <- merge(dat_level,dat_obs_level_xts, all=F)
rm(dat_level, dat_obs_level_xts)
dat_all <- tidy(dat_all)
dat_all <- rbind(dat_all, dat_prec)
dat_all <- rbind(dat_all, data.frame(index=NA, series="NA", value=as.numeric(NA))) # quick and dirty solution to get the legend as desired
gp <- ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "NA"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_bar(data = subset(dat_all, series == "prec"), mapping = aes(colour="Catchment precipitation"), stat = "identity", show.legend = F) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir levels")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "black", "gray50")) +
ylab(expression(paste("Water Volume (", hm^3, ")"))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99), legend.key.width = unit(25,"pt")) +
guides(colour = guide_legend(title=NULL, override.aes = list(size=1.2, bg="white")))
ggsave(file_out_reslevel_paper, plot = gp, width=14, height=6, units="in", dpi=300)
ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "NA"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_bar(data = subset(dat_all, series == "prec"), mapping = aes(colour="Catchment precipitation"), stat = "identity", show.legend = F) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir levels")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "black", "gray50")) +
ylab(expression(paste("Water Volume (", hm^3, ")"))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99), legend.key.width = unit(25,"pt"), legend.key = element_rect(colour = NA)) +
guides(colour = guide_legend(title=NULL, override.aes = list(size=1.2, bg="white")))
ggsave(file_out_reslevel_paper, plot = gp, width=14, height=6, units="in", dpi=300)
gp <- ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "NA"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_bar(data = subset(dat_all, series == "prec"), mapping = aes(colour="Catchment precipitation"), stat = "identity", show.legend = F) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir levels")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "black", "gray50")) +
ylab(expression(paste("Water Volume (", hm^3, ")"))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99), legend.key.width = unit(25,"pt"), legend.key = element_blank()) +
guides(colour = guide_legend(title=NULL, override.aes = list(size=1.2, bg="white")))
ggsave(file_out_reslevel_paper, plot = gp, width=14, height=6, units="in", dpi=300)
library(xts)
library(ggplot2)
library(broom)
library(plyr)
library(dplyr)
library(tidyr)
library(doMC)
registerDoMC(cores=32)
# R object with collected simulation data
dat <- "../collect_results/alldat_Bengue_inflow_m3s_xts.Rdata"
#dat <- "./alldat_Bengue_inflow_m3s_xts.Rdata"
# R object with precipitation data
dat_pr <- "../collect_results/alldat_precip_sum_hm3_xts.Rdata"
#dat_pr <- "./alldat_precip_sum_hm3_xts.Rdata"
# R object with collected simulated reservoir filling volume data
dat_level <- "../collect_results/alldat_Bengue_reslevel_hm3_xts.Rdata"
#dat_level <- "./alldat_Bengue_reslevel_hm3_xts.Rdata"
# output files #
# Bengue inflows: overview
file_out_inflow_overview <- "Bengue_inflow_overview.png"
file_out_reslevel_paper <- "Bengue_resvol_overview.png"
file_out_prec_overview <- "rainfall_area-weighted_overview.png"
file_out_prec_diffs <- "rainfall_maxabsdiff_experiments_overview.png"
file_out_prec_rc_compare <- "Bengue_prec_rc_compare.pdf"
file_out <- "Bengue_inflow"
file_out_vol <- "Bengue_resvol"
# observed data file
file_obs <- "./lista_aportes_diario_177.csv"
# time frame that shall be used for analysis (e.g., warm up period can be excluded); only applied to certain plots
period <- c(as.Date("2006-01-01"), as.Date("2013-12-31"))
load(dat_pr)
dat_all <- dat_all[,1:2] * 1.08 # get values in mm by incorporating catchment area via factor: 1 hm3 / 926 km2 = 1e9 l / 0.926e9 m2 = 1.08 mm
dat_all_m <- apply.monthly(dat_all, colSums, na.rm=F)
dat_all_y <- apply.yearly(dat_all, colSums, na.rm=F)
dat_tidy_d <- cbind(tidy(dat_all), aggregation="daily")
dat_tidy_m <- cbind(tidy(dat_all_m), aggregation="monthly")
dat_tidy_y <- cbind(tidy(dat_all_y), aggregation="yearly")
rm(dat_all, dat_all_m, dat_all_y)
dat_tidy <- rbind(dat_tidy_d, dat_tidy_m, dat_tidy_y)
rm(dat_tidy_d, dat_tidy_m, dat_tidy_y)
dat_tidy
dat_diff <- dat_tidy %>%
ddply(c("index", "aggregation"), .parallel=T, function(x) {
x %>%
summarise(diffs = max(abs(diff(value))))
})
dat_diff
str(dat_tidy)
ggplot(dat_tidy, aes(x=index, y=value, group=series)) +
geom_line(colour="gray", lwd=0.5) +
facet_grid(aggregation ~ ., scale="free_y") +
scale_x_date("Year", limits = c(as.Date("2001-01-01"), as.Date("2013-12-31")), date_breaks = "2 years", date_minor_breaks = "1 year") +
ylab("Rainfall (mm)") +
theme_bw(base_size = 18)
ggplot(dat_tidy, aes(x=index, y=value, group=series)) +
geom_line(colour="gray", lwd=0.5) +
facet_grid(aggregation ~ ., scale="free_y") +
scale_x_date("Year", limits = c(as.Date("2000-01-01"), as.Date("2013-12-31")), date_breaks = "2 years", date_minor_breaks = "1 year") +
ylab("Rainfall (mm)") +
theme_bw(base_size = 18)
dat_diff <- dat_tidy %>%
ddply(c("index", "aggregation"), .parallel=T, function(x) {
x %>%
summarise(diffs = max(abs(diff(value))))
})
dat_diff
str(dat_diff)
load(dat_pr)
str(dat_all)
str(dat_tidy)
str(dat_diff)
str(dat_tidy$index)
str(as.POSIXct(dat_tidy$index))
?as.POSIXct
str(as.POSIXct(dat_tidy$index, tz="UTC"))
names(dat_tidy$index)
names(dat_tidy$series)
names(dat_tidy$value)
names(dat_tidy$aggregation)
?diff
?abs
?max
library(xts)
library(ggplot2)
library(broom)
library(plyr)
library(dplyr)
library(tidyr)
#library(doMC)
#registerDoMC(cores=32)
library(gridExtra)
# R object with collected simulation data
dat <- "../collect_results/alldat_Bengue_inflow_m3s_xts.Rdata"
#dat <- "./alldat_Bengue_inflow_m3s_xts.Rdata"
# R object with precipitation data
dat_pr <- "../collect_results/alldat_precip_sum_hm3_xts.Rdata"
#dat_pr <- "./alldat_precip_sum_hm3_xts.Rdata"
# R object with collected simulated reservoir filling volume data
dat_level <- "../collect_results/alldat_Bengue_reslevel_hm3_xts.Rdata"
#dat_level <- "./alldat_Bengue_reslevel_hm3_xts.Rdata"
# output files #
# Bengue inflows: overview
file_out_inflow_overview <- "Bengue_inflow_overview.png"
file_out_reslevel_paper <- "Bengue_resvol_overview.png"
file_out_prec_overview <- "rainfall_area-weighted_overview.png"
file_out_prec_diffs <- "rainfall_maxabsdiff_experiments_overview.png"
file_out_prec_rc_compare <- "Bengue_prec_rc_compare.pdf"
file_out <- "Bengue_inflow"
file_out_vol <- "Bengue_resvol"
# observed data file
file_obs <- "./lista_aportes_diario_177.csv"
# time frame that shall be used for analysis (e.g., warm up period can be excluded); only applied to certain plots
period <- c(as.Date("2006-01-01"), as.Date("2013-12-31"))
# PRECIPITATION #
load(dat_pr)
dat_all <- dat_all[,1:100] * 1.08 # get values in mm by incorporating catchment area via factor: 1 hm3 / 926 km2 = 1e9 l / 0.926e9 m2 = 1.08 mm
# time series of monthly and yearly sums
dat_all_m <- apply.monthly(dat_all, colSums, na.rm=F)
dat_all_y <- apply.yearly(dat_all, colSums, na.rm=F)
str(dat_all_y)
head(dat_all_y)
str(dat_all_y)
index(dat_all_y)
index(dat_all_y) + 5
index(dat_all_y) - 180
index(dat_all_y) - 354/2
index(dat_all_y) - 365/2
index(dat_all_m) - 15
str(index(dat_all_m) - 15)
index(dat_all_y) <- index(dat_all_y) - 365/2 # yearly values shall be plotted at the middle of the respective year (approximately)
head(dat_all_y)
rm(dat_tidy_d, dat_tidy_m, dat_tidy_y)
?grid.arrange
library(xts)
library(ggplot2)
library(broom)
library(plyr)
library(dplyr)
library(tidyr)
library(gridExtra)
#library(doMC)
#registerDoMC(cores=32)
# R object with collected simulation data
dat <- "../collect_results/alldat_Bengue_inflow_m3s_xts.Rdata"
#dat <- "./alldat_Bengue_inflow_m3s_xts.Rdata"
# R object with precipitation data
dat_pr <- "../collect_results/alldat_precip_sum_hm3_xts.Rdata"
#dat_pr <- "./alldat_precip_sum_hm3_xts.Rdata"
# R object with collected simulated reservoir filling volume data
dat_level <- "../collect_results/alldat_Bengue_reslevel_hm3_xts.Rdata"
#dat_level <- "./alldat_Bengue_reslevel_hm3_xts.Rdata"
# output files #
# Bengue inflows: overview
file_out_inflow_overview <- "Bengue_inflow_overview.png"
file_out_reslevel_paper <- "Bengue_resvol_overview.png"
file_out_prec_overview <- "rainfall_area-weighted_overview.png"
file_out_prec_diffs <- "rainfall_maxabsdiff_experiments_overview.png"
file_out_prec_rc_compare <- "Bengue_prec_rc_compare.pdf"
file_out <- "Bengue_inflow"
file_out_vol <- "Bengue_resvol"
# observed data file
file_obs <- "./lista_aportes_diario_177.csv"
# time frame that shall be used for analysis (e.g., warm up period can be excluded); only applied to certain plots
period <- c(as.Date("2006-01-01"), as.Date("2013-12-31"))
load(dat_level)
dat_level <- dat_all[seq.Date(period[1], period[2], by="day"),1:100]
load(dat_pr)
dat_prec <- dat_all[seq.Date(period[1], period[2], by="day"),1] # only one column as area-weighted precipitation sum over the catchment is almost the same (has been checked)
dat_prec <- tidy(dat_prec)
dat_prec$series <- "prec"
rm(dat_all)
dat_obs <- read.table(file_obs, header=T, sep=";", skip = 4)
dat_obs_level_xts <- xts(dat_obs$Volume..hm.., as.Date(dat_obs$Data))
colnames(dat_obs_level_xts) <- "obs"
rm(dat_obs)
dat_all <- merge(dat_level,dat_obs_level_xts, all=F)
rm(dat_level, dat_obs_level_xts)
dat_all <- tidy(dat_all)
dat_all <- rbind(dat_all, dat_prec)
dat_all <- rbind(dat_all, data.frame(index=NA, series="NA", value=as.numeric(NA))) # quick and dirty solution to get the legend as desired
ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "NA"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_bar(data = subset(dat_all, series == "prec"), mapping = aes(colour="Catchment precipitation"), stat = "identity", show.legend = F) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir levels")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
geom_hline(yintercept = 19.6, colour=hcl(h = 15, l = 65, c = 100), show.legend = F) +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "black", "gray50")) +
ylab(expression(paste("Water Volume (", hm^3, ")"))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99), legend.key.width = unit(25,"pt"), legend.key = element_blank()) +
guides(colour = guide_legend(title=NULL, override.aes = list(size=1.2, bg="white")))
ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "NA"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_bar(data = subset(dat_all, series == "prec"), mapping = aes(colour="Catchment precipitation"), stat = "identity", show.legend = F) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir levels")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
geom_hline(yintercept = 19.6, colour=hcl(h = 15, l = 65, c = 100), show.legend = F, linetype="dashed") +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "black", "gray50")) +
ylab(expression(paste("Water Volume (", hm^3, ")"))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99), legend.key.width = unit(25,"pt"), legend.key = element_blank()) +
guides(colour = guide_legend(title=NULL, override.aes = list(size=1.2, bg="white")))
ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "NA"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_bar(data = subset(dat_all, series == "prec"), mapping = aes(colour="Catchment precipitation"), stat = "identity", show.legend = F) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir levels")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
geom_hline(yintercept = 19.6, colour=hcl(h = 15, l = 65, c = 100), linetype="dashed") +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "black", "gray50")) +
ylab(expression(paste("Water Volume (", hm^3, ")"))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99), legend.key.width = unit(25,"pt"), legend.key = element_blank()) +
guides(colour = guide_legend(title=NULL, override.aes = list(size=1.2, bg="white")))
?hcl
hcl(h = 15, l = 65, c = 100)
ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "NA"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_bar(data = subset(dat_all, series == "prec"), mapping = aes(colour="Catchment precipitation"), stat = "identity", show.legend = F) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir levels")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
geom_hline(yintercept = 19.6, colour="Maximum reservoir level", linetype="dashed") +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "black", "gray50", hcl(h = 15, l = 65, c = 100))) +
ylab(expression(paste("Water Volume (", hm^3, ")"))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99), legend.key.width = unit(25,"pt"), legend.key = element_blank()) +
guides(colour = guide_legend(title=NULL, override.aes = list(size=1.2, bg="white")))
ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "NA"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_bar(data = subset(dat_all, series == "prec"), mapping = aes(colour="Catchment precipitation"), stat = "identity", show.legend = F) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir levels")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
geom_hline(yintercept = 19.6, colour="Maximum reservoir level", linetype="dashed") +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "black", "gray50", "red")) +
ylab(expression(paste("Water Volume (", hm^3, ")"))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99), legend.key.width = unit(25,"pt"), legend.key = element_blank()) +
guides(colour = guide_legend(title=NULL, override.aes = list(size=1.2, bg="white")))
ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "NA"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_bar(data = subset(dat_all, series == "prec"), mapping = aes(colour="Catchment precipitation"), stat = "identity", show.legend = F) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir levels")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
geom_hline(mapping = aes(colour="Maximum reservoir level"), yintercept = 19.6, linetype="dashed") +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "black", "gray50", "red")) +
ylab(expression(paste("Water Volume (", hm^3, ")"))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99), legend.key.width = unit(25,"pt"), legend.key = element_blank()) +
guides(colour = guide_legend(title=NULL, override.aes = list(size=1.2, bg="white")))
ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "NA"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_bar(data = subset(dat_all, series == "prec"), mapping = aes(colour="Catchment precipitation"), stat = "identity", show.legend = F) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir levels")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
geom_hline(mapping = aes(colour="Maximum reservoir level", yintercept = 19.6, linetype="dashed")) +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "black", "gray50", "red")) +
ylab(expression(paste("Water Volume (", hm^3, ")"))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99), legend.key.width = unit(25,"pt"), legend.key = element_blank()) +
guides(colour = guide_legend(title=NULL, override.aes = list(size=1.2, bg="white")))
ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "NA"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_bar(data = subset(dat_all, series == "prec"), mapping = aes(colour="Catchment precipitation"), stat = "identity", show.legend = F) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir levels")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
geom_hline(mapping = aes(colour="Maximum reservoir level", yintercept = 19.6)) +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "black", "gray50", "red")) +
ylab(expression(paste("Water Volume (", hm^3, ")"))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99), legend.key.width = unit(25,"pt"), legend.key = element_blank()) +
guides(colour = guide_legend(title=NULL, override.aes = list(size=1.2, bg="white")))
ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "NA"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_bar(data = subset(dat_all, series == "prec"), mapping = aes(colour="Catchment precipitation"), stat = "identity", show.legend = F) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir levels")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
geom_hline(mapping = aes(colour="Maximum reservoir level", yintercept = 19.6)) +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "red", "black", "gray50")) +
ylab(expression(paste("Water Volume (", hm^3, ")"))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99), legend.key.width = unit(25,"pt"), legend.key = element_blank()) +
guides(colour = guide_legend(title=NULL, override.aes = list(size=1.2, bg="white")))
?scale_color_manual
ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "NA"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_bar(data = subset(dat_all, series == "prec"), mapping = aes(colour="Catchment precipitation"), stat = "identity", show.legend = F) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir levels")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
geom_hline(mapping = aes(colour="Maximum reservoir level", yintercept = 19.6)) +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "red", "black", "gray50")) +
ylab(expression(paste("Water Volume (", hm^3, ")"))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99), legend.key.width = unit(25,"pt"), legend.key = element_blank()) +
guides(colour = guide_legend(title=NULL, override.aes = list(size=1.2, bg="white", type=c(1,2,1,1))))
ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "NA"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_bar(data = subset(dat_all, series == "prec"), mapping = aes(colour="Catchment precipitation"), stat = "identity", show.legend = F) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir levels")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
geom_hline(mapping = aes(colour="Maximum reservoir level", yintercept = 19.6)) +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "red", "black", "gray50")) +
ylab(expression(paste("Water Volume (", hm^3, ")"))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99), legend.key.width = unit(25,"pt"), legend.key = element_blank()) +
guides(colour = guide_legend(title=NULL, override.aes = list(size=1.2, bg="white", linetype=c(1,2,1,1))))
ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "NA"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_bar(data = subset(dat_all, series == "prec"), mapping = aes(colour="Catchment precipitation"), stat = "identity", show.legend = F) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir levels")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
geom_hline(mapping = aes(colour="Maximum reservoir level", yintercept = 19.6), linetype="dashed") +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "red", "black", "gray50")) +
ylab(expression(paste("Water Volume (", hm^3, ")"))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99), legend.key.width = unit(25,"pt"), legend.key = element_blank()) +
guides(colour = guide_legend(title=NULL, override.aes = list(size=1.2, bg="white", linetype=c(1,2,1,1))))
ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "NA"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_bar(data = subset(dat_all, series == "prec"), mapping = aes(colour="Catchment precipitation"), stat = "identity", show.legend = F) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir levels")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
geom_hline(mapping = aes(colour="Maximum reservoir level", yintercept = 19.6), linetype="dashed") +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "red", "black", "gray50")) +
ylab(expression(paste("Water Volume (", hm^3, ")"))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99), legend.key.width = unit(25,"pt"), legend.key = element_blank()) +
guides(colour = guide_legend(title=NULL, override.aes = list(size=1.2, bg="white")))
ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "NA"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_bar(data = subset(dat_all, series == "prec"), mapping = aes(colour="Catchment precipitation"), stat = "identity", show.legend = F) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir levels")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
geom_hline(mapping = aes(colour="Maximum reservoir level", yintercept = 19.6), linetype="dashed") +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "darkred", "black", "gray50")) +
ylab(expression(paste("Water Volume (", hm^3, ")"))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99), legend.key.width = unit(25,"pt"), legend.key = element_blank()) +
guides(colour = guide_legend(title=NULL, override.aes = list(size=1.2, bg="white")))
hcl(h = 15, l = 65, c = 100)
ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "NA"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_bar(data = subset(dat_all, series == "prec"), mapping = aes(colour="Catchment precipitation"), stat = "identity", show.legend = F) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir levels")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
geom_hline(mapping = aes(colour="Maximum reservoir level", yintercept = 19.6), linetype="dashed") +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "#F8766D", "black", "gray50")) +
ylab(expression(paste("Water Volume (", hm^3, ")"))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99), legend.key.width = unit(25,"pt"), legend.key = element_blank()) +
guides(colour = guide_legend(title=NULL, override.aes = list(size=1.2, bg="white")))
gp <- ggplot(dat_all, aes(x=index, y=value, group=series)) +
geom_line(data = subset(dat_all, series == "NA"), lwd=0.5, mapping = aes(colour="Catchment precipitation")) +
geom_bar(data = subset(dat_all, series == "prec"), mapping = aes(colour="Catchment precipitation"), stat = "identity", show.legend = F) +
geom_line(data = subset(dat_all, !(series %in% c("obs", "prec"))), lwd=0.5, mapping = aes(colour="Simulated reservoir levels")) +
geom_line(data = subset(dat_all, series == "obs"), lwd=0.5, mapping = aes(colour="Observed reservoir level")) +
geom_hline(mapping = aes(colour="Maximum reservoir level", yintercept = 19.6), linetype="dashed") +
scale_x_date("Date", date_breaks = "1 year", date_minor_breaks = "1 year") +
scale_color_manual(values=c("lightblue", "#F8766D", "black", "gray50")) +
ylab(expression(paste("Water Volume (", hm^3, ")"))) +
theme_bw(base_size = 18) +
theme(legend.position=c(.99,.99), legend.justification = c(.99,.99), legend.key.width = unit(25,"pt"), legend.key = element_blank()) +
guides(colour = guide_legend(title=NULL, override.aes = list(size=1.2, bg="white")))
#ggsave(file_out_reslevel_paper, plot = gp, width=14, height=6, units="in", dpi=300)
ggsave("test.pdf", plot = gp, width=14, height=6, units="in", dpi=300)
ggsave("test.png", plot = gp, width=14, height=6, units="in", dpi=300)
